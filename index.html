<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ø£Ù†Ù…ÙŠ Ø²ÙŠÙ†</title>

<!-- ===== AdSense Main Script ===== -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9094508203387590"
crossorigin="anonymous"></script>

<style>
body { font-family: Arial, sans-serif; background:#121212; color:#fff; margin:0; padding:0;}
header { background:#ff3b3f; padding:20px; text-align:center; font-size:28px; font-weight:bold; box-shadow:0 4px 10px rgba(0,0,0,0.5);}
.slider { position: relative; width: 100%; max-width: 1000px; margin: 20px auto; overflow: hidden; border-radius: 15px;}
.slides { display:flex; transition: transform 0.8s ease-in-out;}
.slide { min-width:100%; position:relative; cursor: grab; }
.prev, .next { position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,0.6); color:#fff; border:none; border-radius:50%; padding:10px; cursor:pointer; z-index:10;}
.prev{left:10px;} .next{right:10px;}

.anime-section { margin:20px 0; position: relative; }
.anime-list { display:flex; flex-wrap:nowrap; overflow-x:auto; padding:10px; gap:10px; }
.anime-card { background:#1e1e1e; width:180px; border-radius:12px; overflow:hidden; cursor:pointer; transition:0.3s; flex-shrink:0; position:relative; }
.anime-card:hover {transform:scale(1.05); box-shadow:0 0 15px #ff3b3f;}
.anime-card img{width:100%; height:220px; object-fit:cover; transition: transform 0.3s ease; cursor:pointer;}
.anime-card img:active {transform: scale(0.95);}
.card-overlay{ position:absolute; inset:0; background:rgba(0,0,0,0.7); display:flex; justify-content:center; align-items:center; opacity:0; transition:0.3s; text-align:center; color:#fff;}
.anime-card:hover .card-overlay{opacity:1;}

.anime-type-badge { position: absolute; top: 8px; left: 8px; padding: 4px 8px; border-radius: 5px; font-size: 12px; font-weight: bold; color: #fff; }
.anime-type-badge.Ù…Ø³Ù„Ø³Ù„ { background: #28a745; }
.anime-type-badge.ÙÙŠÙ„Ù… { background: #ff3b3f; }
.anime-type-badge.Ù…Ù„Ø®Ù‘Øµ { background: #ff9800; }

.more-card{ background:#ff3b3f; display:flex; align-items:center; justify-content:center; font-size:18px; font-weight:bold; color:white; height:220px; border-radius:12px; cursor:pointer; flex-shrink:0;}
.more-card:hover{background:#ff5559; transform:scale(1.05);}
.add-button{ display:none; margin:20px auto; padding:10px 20px; background:#28a745; color:#fff; border:none; border-radius:8px; cursor:pointer;}

#searchInput{ padding:10px; width:80%; max-width:400px; display:block; margin:10px auto; border-radius:8px; border:none;}
.category-filter{ display:flex; flex-wrap:wrap; justify-content:center; gap:8px; margin:10px; }
.category-filter span{ background:#2a2a2a; padding:6px 14px; border-radius:20px; cursor:pointer; color:#fff;}
.category-filter span.active{ font-weight:bold;}
h2{text-align:center;}
</style>
</head>
<body>

<header>Ø§Ù„Ø£Ù†Ù…ÙŠ Ø²ÙŠÙ†</header>

<div style="text-align:center; margin:15px 0;">
  <ins class="adsbygoogle"
       style="display:block; text-align:center;"
       data-ad-layout="in-article"
       data-ad-format="fluid"
       data-ad-client="ca-pub-9094508203387590"
       data-ad-slot="4839539260"></ins>
  <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div>

<div class="slider">
  <div class="slides" id="slides"></div>
  <button class="prev" onclick="prevSlide()">&#10094;</button>
  <button class="next" onclick="nextSlide()">&#10095;</button>
</div>

<button class="add-button" id="addButton" onclick="askPassword()">Ø¥Ø¶Ø§ÙØ© Ø­Ù„Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>

<input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£Ù†Ù…ÙŠ...">

<div class="category-filter" id="categoryFilter"></div>
<div class="category-filter" id="typeFilter"></div>

<div class="anime-section"><h2>ğŸ¯ Ø§Ù„Ø£Ù†Ù…ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</h2><div class="anime-list" id="animeList"></div></div>
<div class="anime-section"><h2>ğŸ”¥ Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø´Ø§Ù‡Ø¯Ø©</h2><div class="anime-list" id="mostViewedList"></div></div>
<div class="anime-section"><h2>ğŸ’¥ Ø£Ù†Ù…ÙŠ Ø£ÙƒØ´Ù†</h2><div class="anime-list" id="actionList"></div></div>
<div class="anime-section"><h2>ğŸ“º Ù…Ø³Ù„Ø³Ù„Ø§Øª</h2><div class="anime-list" id="seriesList"></div></div>
<div class="anime-section"><h2>ğŸ¬ Ø£ÙÙ„Ø§Ù…</h2><div class="anime-list" id="moviesList"></div></div>
<div class="anime-section"><h2>ğŸ“ Ù…Ù„Ø®Ù‘ØµØ§Øª</h2><div class="anime-list" id="summaryList"></div></div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
 apiKey: "AIzaSyBYEyu6TxSv1qSLCRvr0YCdaVcewhxAmQY",
 authDomain: "appp-1234.firebaseapp.com",
 databaseURL: "https://appp-1234-default-rtdb.firebaseio.com",
 projectId: "appp-1234",
 storageBucket: "appp-1234.firebasestorage.app",
 messagingSenderId: "666495369108",
 appId: "1:666495369108:web:aabf062e066cea6c3b9981"
};
firebase.initializeApp(firebaseConfig);
const animesRef = firebase.database().ref('animes');
</script>

<script>
document.addEventListener("DOMContentLoaded", function(){
  const slidesContainer = document.getElementById("slides");
  const animeList = document.getElementById("animeList");
  const searchInput = document.getElementById("searchInput");
  const categoryFilter = document.getElementById("categoryFilter");
  const typeFilter = document.getElementById("typeFilter");

  let animes = [], currentIndex = 0;
  const categories = ["Ø£ÙƒØ´Ù†","Ù…ØºØ§Ù…Ø±Ø©","Ø±ÙŠØ§Ø¶ÙŠ","ØºÙ…ÙˆØ¶","ÙƒÙˆÙ…ÙŠØ¯ÙŠ","Ø¯Ø±Ø§Ù…Ø§","Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ","Ø®ÙŠØ§Ù„ Ø¹Ù„Ù…ÙŠ","ÙØ§Ù†ØªØ§Ø²ÙŠØ§"];
  const types = ["Ù…Ø³Ù„Ø³Ù„","ÙÙŠÙ„Ù…","Ù…Ù„Ø®Ù‘Øµ"];
  let activeFilters = [], activeTypeFilters = [];

  // Ø§Ù„ÙÙ„Ø§ØªØ±
  categories.forEach(c=>{
    let sp = document.createElement("span");
    sp.textContent = c;
    sp.onclick = () => {
      sp.classList.toggle("active");
      sp.style.background = sp.classList.contains("active")?"#ff3b3f":"#2a2a2a";
      activeFilters = [...document.querySelectorAll("#categoryFilter .active")].map(e=>e.textContent);
      renderAnimeList();
    };
    categoryFilter.appendChild(sp);
  });
  types.forEach(t=>{
    let sp = document.createElement("span");
    sp.textContent = t;
    sp.onclick = () => {
      sp.classList.toggle("active");
      sp.style.background = sp.classList.contains("active")?"#28a745":"#2a2a2a";
      activeTypeFilters = [...document.querySelectorAll("#typeFilter .active")].map(e=>e.textContent);
      renderAnimeList();
    };
    typeFilter.appendChild(sp);
  });

  // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
  animesRef.on('value', snap=>{
    const data = snap.val();
    if(!data) return; 
    animes = Array.isArray(data)?data:Object.values(data);

    renderSlider();
    renderAnimeList();
    renderSection("mostViewedList",[...animes].sort((a,b)=>(b.views||0)-(a.views||0)).slice(0,7));
    renderSection("actionList", animes.filter(a=>a.category?.includes("Ø£ÙƒØ´Ù†")).slice(0,7));
    renderSection("seriesList", animes.filter(a=>a.type==="Ù…Ø³Ù„Ø³Ù„").slice(0,7));
    renderSection("moviesList", animes.filter(a=>a.type==="ÙÙŠÙ„Ù…").slice(0,7));
    renderSection("summaryList", animes.filter(a=>a.type==="Ù…Ù„Ø®Ù‘Øµ").slice(0,7));
  });

  // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
  function buildCard(anime){
    const categoryColors = { "Ø£ÙƒØ´Ù†":"#ff3b3f","Ù…ØºØ§Ù…Ø±Ø©":"#ff9800","Ø±ÙŠØ§Ø¶ÙŠ":"#4caf50","ØºÙ…ÙˆØ¶":"#9c27b0","ÙƒÙˆÙ…ÙŠØ¯ÙŠ":"#ffeb3b","Ø¯Ø±Ø§Ù…Ø§":"#03a9f4","Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ":"#e91e63","Ø®ÙŠØ§Ù„ Ø¹Ù„Ù…ÙŠ":"#00bcd4","ÙØ§Ù†ØªØ§Ø²ÙŠØ§":"#8bc34a" };
    const card = document.createElement("div");
    card.className = "anime-card";
    card.innerHTML = `
      <div style="position:relative">
        <img src="${anime.image}">
        <div class="card-overlay"><h3>${anime.title}</h3></div>
        ${anime.type ? `<span class="anime-type-badge ${anime.type}">${anime.type}</span>` : ''}
      </div>
      <div style="padding:6px 8px; display:flex; flex-wrap:wrap; justify-content:center; gap:4px; background:#2a2a2a; border-top:1px solid #444;">
        ${(anime.category || []).map(c => `<span style="background:${categoryColors[c]||'#555'}; color:${c==='ÙƒÙˆÙ…ÙŠØ¯ÙŠ'?'#000':'#fff'}; padding:2px 6px; border-radius:6px; font-size:11px;">${c}</span>`).join('')}
      </div>`;
    card.onclick = ()=> location.href = `anime.html?title=${encodeURIComponent(anime.title)}`;
    return card;
  }

  // Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
  function renderSlider(){
    slidesContainer.innerHTML = "";
    const categoryColors = { "Ø£ÙƒØ´Ù†":"#ff3b3f","Ù…ØºØ§Ù…Ø±Ø©":"#ff9800","Ø±ÙŠØ§Ø¶ÙŠ":"#4caf50","ØºÙ…ÙˆØ¶":"#9c27b0","ÙƒÙˆÙ…ÙŠØ¯ÙŠ":"#ffeb3b","Ø¯Ø±Ø§Ù…Ø§":"#03a9f4","Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ":"#e91e63","Ø®ÙŠØ§Ù„ Ø¹Ù„Ù…ÙŠ":"#00bcd4","ÙØ§Ù†ØªØ§Ø²ÙŠØ§":"#8bc34a" };
    animes.slice(0,7).forEach(a=>{
      let div = document.createElement("div"); div.className="slide";
      const typeBadge = a.type?`<span class="anime-type-badge ${a.type}" style="position:absolute;top:10px;left:10px;">${a.type}</span>`:"";
      const categoryBadges = (a.category||[]).map(c=>`<span style="background:${categoryColors[c]||'#555'}; color:${c==='ÙƒÙˆÙ…ÙŠØ¯ÙŠ'?'#000':'#fff'}; padding:2px 6px; margin-right:4px; border-radius:5px; font-size:12px;">${c}</span>`).join('');
      const categoryContainer = `<div style="position:absolute; bottom:10px; left:10px; display:flex; flex-wrap:wrap;">${categoryBadges}</div>`;
      div.innerHTML = `<div style="position:relative;"><img src="${a.image}" style="width:100%; height:450px; object-fit:cover; border-radius:15px;">${typeBadge}${categoryContainer}</div>`;
      div.onclick = ()=> location.href = `anime.html?title=${encodeURIComponent(a.title)}`;
      slidesContainer.appendChild(div);
    });
    showSlide();
  }

  // Drag & Swipe
  let isDragging=false, startPos=0, currentTranslate=0, prevTranslate=0, animationID=0;
  slidesContainer.addEventListener('mousedown', dragStart); slidesContainer.addEventListener('touchstart', dragStart);
  slidesContainer.addEventListener('mouseup', dragEnd); slidesContainer.addEventListener('mouseleave', dragEnd); slidesContainer.addEventListener('touchend', dragEnd);
  slidesContainer.addEventListener('mousemove', dragMove); slidesContainer.addEventListener('touchmove', dragMove);
  function dragStart(e){isDragging=true; startPos=getPositionX(e); animationID=requestAnimationFrame(animation);}
  function dragMove(e){if(!isDragging) return; const currentPosition=getPositionX(e); currentTranslate=prevTranslate+currentPosition-startPos;}
  function dragEnd(){cancelAnimationFrame(animationID); isDragging=false; const movedBy=currentTranslate-prevTranslate; if(movedBy<-50&&currentIndex<6) currentIndex++; if(movedBy>50&&currentIndex>0) currentIndex--; setPositionByIndex();}
  function getPositionX(e){return e.type.includes('mouse')?e.pageX:e.touches[0].clientX;}
  function animation(){setSliderPosition(); if(isDragging) requestAnimationFrame(animation);}
  function setSliderPosition(){slidesContainer.style.transform=`translateX(${currentTranslate}px)`;}
  function setPositionByIndex(){currentTranslate=currentIndex*-slidesContainer.offsetWidth; prevTranslate=currentTranslate; slidesContainer.style.transition="transform 0.5s ease"; setSliderPosition(); setTimeout(()=>slidesContainer.style.transition="none",500);}
  function showSlide(){setPositionByIndex();}
  window.nextSlide=()=>{if(currentIndex<6) currentIndex++; showSlide();}
  window.prevSlide=()=>{if(currentIndex>0) currentIndex--; showSlide();}
  setInterval(()=>{if(currentIndex<6) currentIndex++; else currentIndex=0; showSlide();},5000);

  // Ø§Ù„Ø¨Ø­Ø«
  function renderAnimeList(){animeList.innerHTML=""; const text=searchInput.value.toLowerCase(); animes.forEach(a=>{if(!a.title.toLowerCase().includes(text)) return; if(activeFilters.length&&!a.category?.some(c=>activeFilters.includes(c))) return; if(activeTypeFilters.length&&!activeTypeFilters.includes(a.type)) return; animeList.appendChild(buildCard(a));});}
  searchInput.oninput=renderAnimeList;

  // === Ø£Ù‚Ø³Ø§Ù… + Ø²Ø± "Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù…Ø²ÙŠØ¯" Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ===
  function renderSection(id, arr, sectionName){
    const container=document.getElementById(id);
    container.innerHTML="";

    // Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
    arr.forEach(a=>container.appendChild(buildCard(a)));

    // Ø²Ø± Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù…Ø²ÙŠØ¯
    const more = document.createElement("div");
    more.className="more-card";
    more.textContent="Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù…Ø²ÙŠØ¯";

    // Ù†Ù…Ø±Ù‘Ø± Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù… Ù„Ù„Ø±Ø§Ø¨Ø·
    more.onclick = ()=> location.href = `more.html?section=${sectionName}`;

    container.appendChild(more);
  }

  // === Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ===
  animesRef.on('value', snap=>{
    const data = snap.val();
    if(!data) return; 
    animes = Array.isArray(data)?data:Object.values(data);

    renderSlider();
    renderAnimeList();

    renderSection(
      "mostViewedList",
      [...animes].sort((a,b)=>(b.views||0)-(a.views||0)).slice(0,7),
      "mostViewed"
    );

    renderSection(
      "actionList",
      animes.filter(a=>a.category?.includes("Ø£ÙƒØ´Ù†")).slice(0,7),
      "action"
    );

    renderSection(
      "seriesList",
      animes.filter(a=>a.type==="Ù…Ø³Ù„Ø³Ù„").slice(0,7),
      "series"
    );

    renderSection(
      "moviesList",
      animes.filter(a=>a.type==="ÙÙŠÙ„Ù…").slice(0,7),
      "movies"
    );

    renderSection(
      "summaryList",
      animes.filter(a=>a.type==="Ù…Ù„Ø®Ù‘Øµ").slice(0,7),
      "summary"
    );
  });

  // Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø­Ù„Ù‚Ø©
  window.askPassword=()=>{const p=prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:"); if(p==="a") location.href="add_episode.html"; else alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©");};
});
</script>

</body>
</html>
