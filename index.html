<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ø£Ù†Ù…ÙŠ Ø²ÙŠÙ†</title>

<style>
body { font-family: Arial, sans-serif; background:#121212; color:#fff; margin:0; padding:0;}
header { background:#ff3b3f; padding:20px; text-align:center; font-size:28px; font-weight:bold; box-shadow:0 4px 10px rgba(0,0,0,0.5);}

.slider { position: relative; width: 100%; max-width: 1000px; margin: 20px auto; overflow: hidden; border-radius: 15px;}
.slides { display:flex; transition: transform 0.8s ease-in-out;}
.slide { min-width:100%; }
.slide img { width:100%; height:450px; object-fit:cover; border-radius:15px; }

.prev, .next {
 position:absolute; top:50%; transform:translateY(-50%);
 background:rgba(0,0,0,0.6); color:#fff;
 border:none; border-radius:50%; padding:10px; cursor:pointer;
}
.prev{left:10px;} .next{right:10px;}

.anime-list { display:flex; flex-wrap:wrap; justify-content:center; margin:10px;}
.anime-card {
 background:#1e1e1e; margin:10px; width:180px;
 border-radius:12px; overflow:hidden; cursor:pointer;
 transition:0.3s;
}
.anime-card:hover { transform:scale(1.05); box-shadow:0 0 15px #ff3b3f;}
.anime-card img{width:100%; height:220px; object-fit:cover;}
.card-overlay{
 position:absolute; inset:0; background:rgba(0,0,0,0.7);
 display:flex; flex-direction:column; justify-content:center; align-items:center;
 opacity:0; transition:0.3s; text-align:center;
}
.anime-card:hover .card-overlay{opacity:1;}

.badge{padding:3px 6px; border-radius:6px; font-size:12px; margin:2px; display:inline-block;}

.add-button{
 display:block; margin:20px auto; padding:10px 20px;
 background:#28a745; color:#fff; border:none; border-radius:8px;
 cursor:pointer;
}

#searchInput{
 padding:10px; width:80%; max-width:400px; display:block;
 margin:10px auto; border-radius:8px; border:none;
}

.category-filter{
 display:flex; flex-wrap:wrap; justify-content:center; gap:8px; margin:10px;
}
.category-filter span{
 background:#2a2a2a; padding:6px 14px; border-radius:20px; cursor:pointer;
}

h2{ text-align:center; margin-top:30px;}
</style>
</head>
<body>

<header>Ø§Ù„Ø£Ù†Ù…ÙŠ Ø²ÙŠÙ†</header>

<div class="slider">
    <div class="slides" id="slides"></div>
    <button class="prev" onclick="prevSlide()">&#10094;</button>
    <button class="next" onclick="nextSlide()">&#10095;</button>
</div>

<button class="add-button" onclick="askPassword()">Ø¥Ø¶Ø§ÙØ© Ø­Ù„Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>

<input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£Ù†Ù…ÙŠ...">

<div class="category-filter" id="categoryFilter"></div>
<div class="category-filter" id="typeFilter"></div>

<div class="anime-list" id="animeList"></div>

<h2>ğŸ”¥ Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø´Ø§Ù‡Ø¯Ø©</h2>
<div class="anime-list" id="mostViewedList"></div>

<h2>ğŸ’¥ Ø£Ù†Ù…ÙŠ Ø£ÙƒØ´Ù†</h2>
<div class="anime-list" id="actionList"></div>

<h2>ğŸ“º Ù…Ø³Ù„Ø³Ù„Ø§Øª</h2>
<div class="anime-list" id="seriesList"></div>

<h2>ğŸ¬ Ø£ÙÙ„Ø§Ù…</h2>
<div class="anime-list" id="moviesList"></div>


<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
 apiKey: "AIzaSyBYEyu6TxSv1qSLCRvr0YCdaVcewhxAmQY",
 authDomain: "appp-1234.firebaseapp.com",
 databaseURL: "https://appp-1234-default-rtdb.firebaseio.com",
 projectId: "appp-1234",
 storageBucket: "appp-1234.firebasestorage.app",
 messagingSenderId: "666495369108",
 appId: "1:666495369108:web:aabf062e066cea6c3b9981"
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();
const animesRef = database.ref('animes');
</script>

<script>
document.addEventListener("DOMContentLoaded", function(){

const slidesContainer = document.getElementById("slides");
const animeList = document.getElementById("animeList");
const searchInput = document.getElementById("searchInput");

let animes = [];
let currentIndex = 0;

const categories = ["Ø£ÙƒØ´Ù†","Ù…ØºØ§Ù…Ø±Ø©","Ø±ÙŠØ§Ø¶ÙŠ","ØºÙ…ÙˆØ¶","ÙƒÙˆÙ…ÙŠØ¯ÙŠ","Ø¯Ø±Ø§Ù…Ø§","Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ","Ø®ÙŠØ§Ù„ Ø¹Ù„Ù…ÙŠ","ÙØ§Ù†ØªØ§Ø²ÙŠØ§"];
const categoryColors = {
 "Ø£ÙƒØ´Ù†":"#ff3b3f","Ù…ØºØ§Ù…Ø±Ø©":"#ff7f50","Ø±ÙŠØ§Ø¶ÙŠ":"#1e90ff","ØºÙ…ÙˆØ¶":"#8a2be2",
 "ÙƒÙˆÙ…ÙŠØ¯ÙŠ":"#ffd700","Ø¯Ø±Ø§Ù…Ø§":"#ff69b4","Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ":"#ff1493",
 "Ø®ÙŠØ§Ù„ Ø¹Ù„Ù…ÙŠ":"#00ced1","ÙØ§Ù†ØªØ§Ø²ÙŠØ§":"#32cd32"
};

const types = ["Ù…Ø³Ù„Ø³Ù„","ÙÙŠÙ„Ù…"];
let activeFilters=[];
let activeTypeFilters=[];

// ØªØµÙ†ÙŠÙØ§Øª
categories.forEach(c=>{
 let sp=document.createElement("span");
 sp.textContent=c;
 sp.onclick=()=>{
   sp.classList.toggle("active");
   sp.style.background = sp.classList.contains("active") ? categoryColors[c]:"#2a2a2a";
   activeFilters=[...document.querySelectorAll("#categoryFilter .active")].map(e=>e.textContent);
   renderAnimeList();
 };
 categoryFilter.appendChild(sp);
});

// Ø£Ù†ÙˆØ§Ø¹
types.forEach(t=>{
 let sp=document.createElement("span");
 sp.textContent=t;
 sp.onclick=()=>{
   sp.classList.toggle("active");
   sp.style.background = sp.classList.contains("active") ? "#28a745":"#2a2a2a";
   activeTypeFilters=[...document.querySelectorAll("#typeFilter .active")].map(e=>e.textContent);
   renderAnimeList();
 };
 typeFilter.appendChild(sp);
});

animesRef.on('value', snap=>{
 const data = snap.val();
 if(data){
   animes = Array.isArray(data)?data:Object.values(data);
   renderSlider();
   renderAnimeList();
   renderMostViewed();
   renderAction();
   renderSeries();
   renderMovies();
 }
});

function buildCard(anime){
 let lastSeason = anime.episodes?.length ? anime.episodes.at(-1).season : anime.season;
 const card=document.createElement("div");
 card.className="anime-card";
 card.innerHTML=`
   <div style="position:relative">
     <img src="${anime.image}">
     <div class="card-overlay">
       <h3>${anime.title} - ${lastSeason}</h3>
     </div>
   </div>`;
 card.onclick=()=>location.href=`anime.html?title=${encodeURIComponent(anime.title)}`;
 return card;
}

// Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
function renderSlider(){
 slidesContainer.innerHTML="";
 animes.slice(0,10).forEach(a=>{
   let div=document.createElement("div");
   div.className="slide";
   div.innerHTML=`<img src="${a.image}">`;
   slidesContainer.appendChild(div);
 });
 showSlide();
}

function showSlide(){
 slidesContainer.style.transform=`translateX(-${currentIndex*100}%)`;
}
window.nextSlide=()=>{currentIndex=(currentIndex+1)%10;showSlide();}
window.prevSlide=()=>{currentIndex=(currentIndex-1+10)%10;showSlide();}
setInterval(nextSlide,5000);

// Ø§Ù„Ù„Ø§Ø¦Ø­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
function renderAnimeList(){
 animeList.innerHTML="";
 const text=searchInput.value.toLowerCase();
 animes.forEach(a=>{
   if(!a.title.toLowerCase().includes(text)) return;
   if(activeFilters.length && !a.category?.some(c=>activeFilters.includes(c))) return;
   if(activeTypeFilters.length && !activeTypeFilters.includes(a.type)) return;
   animeList.appendChild(buildCard(a));
 });
}

// Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
function renderMostViewed(){
 const c=document.getElementById("mostViewedList");
 c.innerHTML="";
 [...animes].sort((a,b)=>(b.episodes?.length||0)-(a.episodes?.length||0))
 .slice(0,10).forEach(a=>c.appendChild(buildCard(a)));
}

function renderAction(){
 const c=document.getElementById("actionList");
 c.innerHTML="";
 animes.filter(a=>a.category?.includes("Ø£ÙƒØ´Ù†"))
 .slice(0,10).forEach(a=>c.appendChild(buildCard(a)));
}

function renderSeries(){
 const c=document.getElementById("seriesList");
 c.innerHTML="";
 animes.filter(a=>a.type==="Ù…Ø³Ù„Ø³Ù„")
 .slice(0,10).forEach(a=>c.appendChild(buildCard(a)));
}

function renderMovies(){
 const c=document.getElementById("moviesList");
 c.innerHTML="";
 animes.filter(a=>a.type==="ÙÙŠÙ„Ù…")
 .slice(0,10).forEach(a=>c.appendChild(buildCard(a)));
}

searchInput.oninput=renderAnimeList;

// Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ©
window.askPassword=()=>{
 const p=prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:");
 if(p==="HICH@M1990") location.href="add_episode.html";
 else alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©");
};

});
</script>

</body>
</html>
